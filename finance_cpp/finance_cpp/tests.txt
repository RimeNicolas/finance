
void test_cholesky() {
	constexpr size_t n = 3;
	Tensor2<double, n> cov_matrix = { {0} };
	cov_matrix[0][0] = 4;
	cov_matrix[0][1] = 12;
	cov_matrix[0][2] = -16;
	cov_matrix[1][0] = 12;
	cov_matrix[1][1] = 37;
	cov_matrix[1][2] = -43;
	cov_matrix[2][0] = -16;
	cov_matrix[2][1] = -43;
	cov_matrix[2][2] = 98;

	print_array(cov_matrix);

	Tensor2<double, n> low_triangular = \
		cholesky_factorisation(cov_matrix);

	std::cout << std::endl;
	print_array(low_triangular);
}

void test_covariance_matrix() {
	RandomGeneratorLewis randgen(0);

	std::array<double, 3> mu = { 0,0,0 };
	Tensor2<double, 3> cov_matrix = { {0} };
	cov_matrix[0][0] = 4;
	cov_matrix[0][1] = 12;
	cov_matrix[0][2] = -16;
	cov_matrix[1][0] = 12;
	cov_matrix[1][1] = 37;
	cov_matrix[1][2] = -43;
	cov_matrix[2][0] = -16;
	cov_matrix[2][1] = -43;
	cov_matrix[2][2] = 98;

	print_array(cov_matrix);

	Tensor2<double, 3> low_triangular = \
		cholesky_factorisation(cov_matrix);

	std::cout << std::endl;
	print_array(low_triangular);

	std::array<double, 3> z = randgen.normal_array(mu, cov_matrix);

	print_array(z);
}


